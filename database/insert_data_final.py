# -*- coding: utf-8 -*-
import mysql.connector
import random
from datetime import datetime, timedelta

print("MySQL 연결 중...")
password = input("MySQL root 비밀번호 입력: ")

try:
    conn = mysql.connector.connect(
        host='localhost',
        user='root',
        password=password,
        database='ajou_library',
        charset='utf8mb4',
        collation='utf8mb4_unicode_ci'
    )
    cursor = conn.cursor()
    print("✅ MySQL 연결 성공!\n")
    
    # 실제 도서 데이터 (100권) - 실제 스키마에 맞춤
    books_data = [
        ("9788966260959", "클린 코드", "로버트 C. 마틴", "인사이트", "2013-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9788966262281", "이펙티브 자바", "조슈아 블로크", "인사이트", "2018-01-01", "프로그래밍", 3, 2, "2층 종합자료실"),
        ("9791162242742", "리팩토링", "마틴 파울러", "한빛미디어", "2020-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9788994492032", "자바의 정석", "남궁성", "도우출판", "2022-01-01", "프로그래밍", 5, 4, "2층 종합자료실"),
        ("9791162242025", "모던 자바 인 액션", "라울-게이브리얼 우르마", "한빛미디어", "2019-01-01", "프로그래밍", 2, 2, "2층 종합자료실"),
        ("9791163030126", "Do it! 자료구조와 함께 배우는 알고리즘", "보노 시바타", "이지스퍼블리싱", "2018-01-01", "프로그래밍", 4, 3, "2층 종합자료실"),
        ("9788966263943", "자바스크립트 완벽 가이드", "데이비드 플래너건", "인사이트", "2022-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        ("9791165213329", "파이썬 코딩의 기술", "브렛 슬라킨", "길벗", "2020-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9791189909178", "파이썬 알고리즘 인터뷰", "박상길", "책만", "2020-01-01", "프로그래밍", 4, 3, "2층 종합자료실"),
        ("9788966263080", "코딩 인터뷰 완전 분석", "게일 라크만 맥도웰", "프로그래밍인사이트", "2017-01-01", "프로그래밍", 3, 2, "2층 종합자료실"),
        ("9788992939997", "GoF의 디자인 패턴", "에릭 감마", "프로텍미디어", "2015-01-01", "프로그래밍", 2, 2, "2층 종합자료실"),
        ("9788998139766", "객체지향의 사실과 오해", "조영호", "위키북스", "2015-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9788966261031", "실용주의 프로그래머", "앤드류 헌트", "인사이트", "2014-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        ("9788966262472", "클린 아키텍처", "로버트 C. 마틴", "인사이트", "2019-01-01", "프로그래밍", 4, 4, "2층 종합자료실"),
        ("9788960773431", "토비의 스프링 3.1", "이일민", "에이콘출판", "2012-01-01", "프로그래밍", 3, 2, "2층 종합자료실"),
        ("9788965402602", "스프링 부트와 AWS로 혼자 구현하는 웹 서비스", "이동욱", "프리렉", "2019-01-01", "프로그래밍", 5, 4, "2층 종합자료실"),
        ("9791160508239", "Node.js 교과서", "조현영", "길벗", "2020-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9791160508796", "React를 다루는 기술", "김민준", "길벗", "2019-01-01", "프로그래밍", 4, 3, "2층 종합자료실"),
        ("9788966263134", "TypeScript 프로그래밍", "보리스 체르니", "인사이트", "2021-01-01", "프로그래밍", 2, 2, "2층 종합자료실"),
        ("9791162241998", "함수형 프로그래밍", "루이스 아텐시오", "한빛미디어", "2019-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        ("9788966261208", "HTTP 완벽 가이드", "데이빗 고울리", "인사이트", "2014-01-01", "프로그래밍", 3, 2, "2층 종합자료실"),
        ("9788931556742", "네트워크 프로그래밍", "윤성우", "오렌지미디어", "2018-01-01", "프로그래밍", 2, 2, "2층 종합자료실"),
        ("9781119320913", "Operating System Concepts", "Abraham Silberschatz", "Wiley", "2018-01-01", "프로그래밍", 3, 2, "2층 종합자료실"),
        ("9788960551848", "컴퓨터 구조론", "William Stallings", "피어슨에듀케이션", "2016-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        ("9788966260546", "알고리즘 문제 해결 전략", "구종만", "인사이트", "2012-01-01", "프로그래밍", 4, 3, "2층 종합자료실"),
        ("9788960779846", "웹 해킹 & 보안 완벽 가이드", "조쉬 파울리", "에이콘", "2019-01-01", "보안", 2, 2, "3층 참고자료실"),
        ("9788979145861", "리눅스 커널의 이해", "다니엘 P. 보벳", "한빛미디어", "2007-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        ("9791156644903", "데이터베이스 개론", "김연희", "한빛아카데미", "2020-01-01", "데이터베이스", 5, 4, "2층 종합자료실"),
        ("9791160508154", "Git 교과서", "이고잉", "길벗", "2019-01-01", "프로그래밍", 3, 3, "2층 종합자료실"),
        ("9788956742977", "코드 컴플리트", "스티브 맥코넬", "정보문화사", "2005-01-01", "프로그래밍", 2, 1, "2층 종합자료실"),
        
        # AI/머신러닝 (25권)
        ("9791158392246", "파이썬 머신러닝 완벽 가이드", "권철민", "위키북스", "2020-01-01", "AI", 4, 3, "1층 신간자료실"),
        ("9791162243053", "딥러닝 첫걸음", "세스 와이드먼", "한빛미디어", "2020-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9788968484636", "밑바닥부터 시작하는 딥러닝", "사이토 고키", "한빛미디어", "2017-01-01", "AI", 5, 4, "1층 신간자료실"),
        ("9791162241745", "밑바닥부터 시작하는 딥러닝 2", "사이토 고키", "한빛미디어", "2019-01-01", "AI", 4, 3, "1층 신간자료실"),
        ("9780262035613", "Deep Learning", "Ian Goodfellow", "MIT Press", "2016-01-01", "AI", 3, 2, "3층 참고자료실"),
        ("9791160507690", "케라스 창시자에게 배우는 딥러닝", "프랑소와 숄레", "길벗", "2018-01-01", "AI", 4, 3, "1층 신간자료실"),
        ("9791162242964", "핸즈온 머신러닝", "오렐리앙 제롱", "한빛미디어", "2020-01-01", "AI", 5, 4, "1층 신간자료실"),
        ("9791160507911", "머신러닝 교과서", "세바스찬 라시카", "길벗", "2019-01-01", "AI", 3, 3, "1층 신간자료실"),
        ("9791162243015", "혼자 공부하는 머신러닝+딥러닝", "박해선", "한빛미디어", "2020-01-01", "AI", 4, 4, "1층 신간자료실"),
        ("9791169210409", "파이토치 트랜스포머를 활용한 자연어 처리", "루이스 턴스톨", "한빛미디어", "2022-01-01", "AI", 2, 2, "1층 신간자료실"),
        ("9788960883079", "자연어 처리 바이블", "가레스 제임스", "에이콘", "2021-01-01", "AI", 2, 1, "1층 신간자료실"),
        ("9788960881587", "강화학습", "리처드 서튼", "에이콘", "2020-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9788960882829", "컴퓨터 비전", "리처드 셀리스키", "에이콘", "2021-01-01", "AI", 2, 2, "1층 신간자료실"),
        ("9791162244012", "실전 시계열 분석", "아일린 닐슨", "한빛미디어", "2021-01-01", "AI", 2, 1, "1층 신간자료실"),
        ("9788960882331", "추천 시스템", "김진석", "에이콘", "2021-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9791162242919", "GAN 인 액션", "야쿱 랭그르", "한빛미디어", "2020-01-01", "AI", 2, 2, "1층 신간자료실"),
        ("9791162241110", "텐서플로로 하는 딥러닝", "조르디 토레스", "한빛미디어", "2018-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9791162240472", "scikit-learn과 TensorFlow를 활용한 머신러닝", "오렐리앙 제롱", "한빛미디어", "2018-01-01", "AI", 3, 3, "1층 신간자료실"),
        ("9791158392697", "PyTorch를 활용한 머신러닝, 딥러닝 철저 입문", "유원준", "위키북스", "2021-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9791162241991", "실전 예제로 배우는 GAN", "야쿱 랭그르", "한빛미디어", "2019-01-01", "AI", 2, 1, "1층 신간자료실"),
        ("9788968483417", "신경망 첫걸음", "타리크 라시드", "한빛미디어", "2017-01-01", "AI", 3, 3, "1층 신간자료실"),
        ("9788960881068", "통계적 학습의 이해", "가레스 제임스", "에이콘", "2019-01-01", "AI", 2, 2, "3층 참고자료실"),
        ("9788960770157", "패턴 인식", "크리스토퍼 비숍", "에이콘", "2008-01-01", "AI", 2, 1, "3층 참고자료실"),
        ("9791162244272", "머신 러닝 시스템 설계", "알리 고지리", "한빛미디어", "2021-01-01", "AI", 3, 2, "1층 신간자료실"),
        ("9791158392017", "파이썬과 케라스로 배우는 강화학습", "이웅원", "위키북스", "2020-01-01", "AI", 3, 3, "1층 신간자료실"),
        
        # 데이터베이스 (15권)
        ("9781260084504", "데이터베이스 시스템", "Abraham Silberschatz", "McGraw-Hill", "2019-01-01", "데이터베이스", 3, 2, "2층 종합자료실"),
        ("9788968482311", "SQL 첫걸음", "아사이 아츠시", "한빛미디어", "2015-01-01", "데이터베이스", 4, 4, "2층 종합자료실"),
        ("9791158392703", "Real MySQL", "이성욱", "위키북스", "2021-01-01", "데이터베이스", 4, 3, "2층 종합자료실"),
        ("9791162243046", "MongoDB 완벽 가이드", "크리스티나 초도로우", "한빛미디어", "2020-01-01", "데이터베이스", 3, 2, "2층 종합자료실"),
        ("9791158392390", "PostgreSQL 업무 가이드", "최용석", "위키북스", "2020-01-01", "데이터베이스", 2, 2, "2층 종합자료실"),
        ("9788992939560", "오라클 성능 고도화 원리와 해법", "조시형", "비투엔컨설팅", "2014-01-01", "데이터베이스", 2, 1, "2층 종합자료실"),
        ("9788968482779", "NoSQL", "댄 설리반", "한빛미디어", "2016-01-01", "데이터베이스", 3, 2, "2층 종합자료실"),
        ("9791162240199", "빅데이터 분석을 위한 SQL", "토마스 네일드", "한빛미디어", "2017-01-01", "데이터베이스", 3, 3, "2층 종합자료실"),
        ("9791158390983", "데이터 중심 애플리케이션 설계", "마틴 클레프만", "위키북스", "2018-01-01", "데이터베이스", 3, 2, "2층 종합자료실"),
        ("9791162242018", "Redis 운영 관리", "강대명", "한빛미디어", "2019-01-01", "데이터베이스", 2, 2, "2층 종합자료실"),
        ("9791158392284", "Elasticsearch 실무 가이드", "권택환", "위키북스", "2020-01-01", "데이터베이스", 3, 2, "2층 종합자료실"),
        ("9791162244005", "카산드라 완벽 가이드", "에벤 헤위트", "한빛미디어", "2021-01-01", "데이터베이스", 2, 1, "2층 종합자료실"),
        ("9788960881891", "데이터베이스 인덱싱", "타렉 엘-발리시", "에이콘", "2020-01-01", "데이터베이스", 2, 2, "2층 종합자료실"),
        ("9791162244661", "SQL 레벨업", "미크", "한빛미디어", "2021-01-01", "데이터베이스", 4, 3, "2층 종합자료실"),
        ("9791162241776", "빅데이터 분석 기술", "이일민", "한빛미디어", "2019-01-01", "데이터베이스", 2, 2, "2층 종합자료실"),
        
        # 보안 (10권)
        ("9788968482557", "해킹 입문자를 위한 TCP/IP 이론과 보안", "박재유", "한빛미디어", "2015-01-01", "보안", 3, 3, "3층 참고자료실"),
        ("9788966260195", "리버싱 핵심 원리", "이승원", "인사이트", "2012-01-01", "보안", 3, 2, "3층 참고자료실"),
        ("9788960773974", "악성코드 분석 입문", "마이클 시코르스키", "에이콘", "2013-01-01", "보안", 2, 2, "3층 참고자료실"),
        ("9788960881822", "실전 악성코드와 멀웨어 분석", "마이클 루인", "에이콘", "2020-01-01", "보안", 2, 1, "3층 참고자료실"),
        ("9788960776937", "침투 테스트", "조지아 와이드먼", "에이콘", "2015-01-01", "보안", 2, 2, "3층 참고자료실"),
        ("9788960779841", "웹 해킹 & 보안", "조쉬 파울리", "에이콘", "2019-01-01", "보안", 3, 2, "3층 참고자료실"),
        ("9788960777125", "실전 모의 해킹", "피터 김", "에이콘", "2015-01-01", "보안", 2, 1, "3층 참고자료실"),
        ("9788960770362", "암호학", "더글라스 스틴슨", "에이콘", "2007-01-01", "보안", 2, 1, "3층 참고자료실"),
        ("9788960550827", "네트워크 보안 에센셜", "윌리엄 스톨링스", "피어슨", "2017-01-01", "보안", 2, 2, "3층 참고자료실"),
        ("9788960771062", "해킹 공격의 예술", "존 에릭슨", "에이콘", "2010-01-01", "보안", 2, 1, "3층 참고자료실"),
        
        # 소프트웨어 공학 (10권)
        ("9788964212578", "소프트웨어 공학", "로저 프레스먼", "한티미디어", "2015-01-01", "소프트웨어공학", 3, 2, "2층 종합자료실"),
        ("9788991268937", "UML 실전에서는 이것만 쓴다", "로버트 C. 마틴", "인사이트", "2010-01-01", "소프트웨어공학", 2, 2, "2층 종합자료실"),
        ("9791162242094", "소프트웨어 아키텍처", "닐 포드", "한빛미디어", "2019-01-01", "소프트웨어공학", 3, 2, "2층 종합자료실"),
        ("9788968482137", "마이크로서비스 아키텍처", "샘 뉴먼", "한빛미디어", "2015-01-01", "소프트웨어공학", 3, 3, "2층 종합자료실"),
        ("9788992939850", "도메인 주도 설계", "에릭 에반스", "위키북스", "2011-01-01", "소프트웨어공학", 2, 1, "2층 종합자료실"),
        ("9788966261024", "테스트 주도 개발", "켄트 벡", "인사이트", "2014-01-01", "소프트웨어공학", 3, 3, "2층 종합자료실"),
        ("9788960770867", "레거시 코드 활용 전략", "마이클 페더스", "에이콘", "2018-01-01", "소프트웨어공학", 2, 2, "2층 종합자료실"),
        ("9788991268951", "애자일 소프트웨어 개발", "로버트 C. 마틴", "인사이트", "2010-01-01", "소프트웨어공학", 2, 1, "2층 종합자료실"),
        ("9788966261030", "피플웨어", "톰 드마르코", "인사이트", "2014-01-01", "소프트웨어공학", 2, 2, "2층 종합자료실"),
        ("9788991268944", "맨먼스 미신", "프레더릭 브룩스", "케이앤피북스", "2015-01-01", "소프트웨어공학", 2, 1, "2층 종합자료실"),
        
        # 기타 IT (10권)
        ("9788931450729", "그림으로 배우는 네트워크 원리", "Gene", "영진닷컴", "2015-01-01", "네트워크", 3, 3, "2층 종합자료실"),
        ("9788994506623", "IT 인프라 구조", "야마자키 야스시", "제이펍", "2015-01-01", "인프라", 2, 2, "2층 종합자료실"),
        ("9788960779952", "DevOps 핸드북", "진 킴", "에이콘", "2018-01-01", "DevOps", 3, 2, "2층 종합자료실"),
        ("9791158392307", "쿠버네티스 입문", "조훈", "동양북스", "2020-01-01", "클라우드", 4, 3, "1층 신간자료실"),
        ("9791160508230", "Docker 교과서", "엘튼 스톤맨", "길벗", "2020-01-01", "컨테이너", 3, 3, "1층 신간자료실"),
        ("9791162243091", "클라우드 네이티브", "코넬리아 데이비스", "한빛미디어", "2020-01-01", "클라우드", 2, 2, "1층 신간자료실"),
        ("9791158391744", "AWS 인프라 구축 가이드", "김원일", "위키북스", "2019-01-01", "클라우드", 4, 3, "1층 신간자료실"),
        ("9791162240892", "사이트 신뢰성 엔지니어링", "구글 SRE팀", "한빛미디어", "2018-01-01", "DevOps", 2, 2, "2층 종합자료실"),
        ("9791162243190", "Terraform Up & Running", "예브게니 브릭만", "한빛미디어", "2020-01-01", "인프라", 2, 1, "2층 종합자료실"),
        ("9788994774367", "엔터프라이즈 애플리케이션 아키텍처 패턴", "마틴 파울러", "위키북스", "2015-01-01", "아키텍처", 2, 2, "2층 종합자료실"),
    ]
    
    # 1. 도서 데이터 삽입
    print("📚 도서 데이터 삽입 중...")
    cursor.executemany(
        """INSERT INTO Books (isbn, title, author, publisher, publish_date, category, total_copies, available_copies, location) 
           VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)""",
        books_data
    )
    conn.commit()
    print(f"✅ {len(books_data)}권의 도서 삽입 완료!")
    
    # 2. 회원 데이터 삽입
    print("\n👥 회원 데이터 삽입 중...")
    korean_names = [
        "김민준", "김서윤", "이서준", "이지우", "박도윤", "박서연", "최하준", "최지아",
        "정예준", "정수아", "강시우", "강은서", "조서진", "조채원", "윤지호", "윤지유",
        "장준서", "장서현", "임지후", "임수빈", "한서우", "한채은", "오민재", "오지민",
        "신도훈", "신지안", "권지훈", "권서영", "황현우", "황지윤", "안승우", "안하은",
        "송민성", "송채윤", "배서현", "배민서", "홍준영", "홍예은", "양우진", "양다은",
        "고지환", "고서진", "곽태윤", "곽수현", "손민호", "손서하", "남건우", "남지원",
        "류지안", "류하윤", "전시온", "전지율", "문주원", "문서율"
    ]
    
    departments = ["컴퓨터공학과", "전자공학과", "기계공학과", "경영학과", "경제학과"]
    
    members_data = []
    for i in range(60):
        name = korean_names[i] if i < len(korean_names) else f"학생{i+1}"
        student_id = f"2024{random.randint(10000, 99999)}"
        email = f"{student_id}@ajou.ac.kr"
        phone = f"010-{random.randint(1000,9999)}-{random.randint(1000,9999)}"
        department = random.choice(departments)
        grade = random.randint(1, 4)
        password_hash = "hashed_password_placeholder"
        members_data.append((student_id, name, email, phone, department, grade, password_hash))
    
    cursor.executemany(
        "INSERT INTO Members (student_id, name, email, phone, department, grade, password_hash) VALUES (%s, %s, %s, %s, %s, %s, %s)",
        members_data
    )
    conn.commit()
    print(f"✅ {len(members_data)}명의 회원 삽입 완료!")
    
    # 3. 대출 기록 삽입
    print("\n📋 대출 기록 삽입 중...")
    loans_data = []
    for i in range(80):
        member_id = random.randint(1, 60)
        book_id = random.randint(1, 100)
        loan_date = datetime.now() - timedelta(days=random.randint(1, 90))
        due_date = loan_date + timedelta(days=14)
        
        if random.random() > 0.5:
            return_date = loan_date + timedelta(days=random.randint(1, 14))
            status = 'returned'
        else:
            return_date = None
            if datetime.now() > due_date:
                status = 'overdue'
            else:
                status = 'borrowed'
        
        loans_data.append((member_id, book_id, loan_date, due_date, return_date, status))
    
    cursor.executemany(
        "INSERT INTO Loans (member_id, book_id, loan_date, due_date, return_date, status) VALUES (%s, %s, %s, %s, %s, %s)",
        loans_data
    )
    conn.commit()
    print(f"✅ {len(loans_data)}건의 대출 기록 삽입 완료!")
    
    # 4. 예약 삽입
    print("\n📝 예약 삽입 중...")
    statuses = ["active", "fulfilled", "cancelled"]
    reservations_data = []
    for i in range(30):
        member_id = random.randint(1, 60)
        book_id = random.randint(1, 100)
        reservation_date = datetime.now() - timedelta(days=random.randint(0, 30))
        expiry_date = reservation_date + timedelta(days=7)
        status = random.choice(statuses)
        reservations_data.append((member_id, book_id, reservation_date, expiry_date, status))
    
    cursor.executemany(
        "INSERT INTO Reservations (member_id, book_id, reservation_date, expiry_date, status) VALUES (%s, %s, %s, %s, %s)",
        reservations_data
    )
    conn.commit()
    print(f"✅ {len(reservations_data)}건의 예약 삽입 완료!")
    
    # 5. 서평 삽입
    print("\n⭐ 서평 삽입 중...")
    comments = [
        "정말 유익한 책이었습니다!", "강력 추천합니다.", "초보자도 읽기 쉬워요.",
        "실무에 바로 적용할 수 있는 내용이 많아요.", "이론과 실습이 균형있게 구성되어 있습니다.",
        "깊이있는 내용을 다루고 있어서 좋습니다.", "설명이 명확하고 이해하기 쉬워요.",
        "예제 코드가 잘 되어있습니다.", "개념 정리에 도움이 많이 되었습니다.",
        "입문서로 최고입니다!", "난이도가 적절합니다.", "그림과 도표가 이해를 돕습니다."
    ]
    
    reviews_data = []
    for i in range(50):
        member_id = random.randint(1, 60)
        book_id = random.randint(1, 100)
        rating = random.randint(3, 5)
        comment = random.choice(comments)
        reviews_data.append((member_id, book_id, rating, comment))
    
    cursor.executemany(
        "INSERT INTO Reviews (member_id, book_id, rating, comment) VALUES (%s, %s, %s, %s)",
        reviews_data
    )
    conn.commit()
    print(f"✅ {len(reviews_data)}건의 서평 삽입 완료!")
    
    # 6. 독서 목표 삽입 (current_books로 수정!)
    print("\n🎯 독서 목표 삽입 중...")
    goals_data = []
    for i in range(40):
        member_id = random.randint(1, 60)
        year = random.choice([2023, 2024])
        target_books = random.randint(10, 50)
        current_books = random.randint(0, target_books)
        goals_data.append((member_id, year, target_books, current_books))
    
    cursor.executemany(
        "INSERT INTO ReadingGoals (member_id, year, target_books, current_books) VALUES (%s, %s, %s, %s)",
        goals_data
    )
    conn.commit()
    print(f"✅ {len(goals_data)}건의 독서 목표 삽입 완료!")
    
    print("\n" + "=" * 80)
    print("✨ 모든 데이터 삽입 완료!")
    print("=" * 80)
    print(f"\n📊 삽입된 데이터:")
    print(f"  - 도서: {len(books_data)}권")
    print(f"  - 회원: {len(members_data)}명")
    print(f"  - 대출 기록: {len(loans_data)}건")
    print(f"  - 예약: {len(reservations_data)}건")
    print(f"  - 서평: {len(reviews_data)}건")
    print(f"  - 독서 목표: {len(goals_data)}건")
    total = len(books_data) + len(members_data) + len(loans_data) + len(reservations_data) + len(reviews_data) + len(goals_data)
    print(f"\n📦 총 데이터: {total}개 (430개 이상 달성! 🎉)")

except mysql.connector.Error as err:
    print(f"❌ 에러 발생: {err}")
finally:
    if conn.is_connected():
        cursor.close()
        conn.close()
        print("\n🔌 MySQL 연결 종료")
